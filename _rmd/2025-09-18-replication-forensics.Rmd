---
title: "Replication Forensics: A Learning Experience for Students"
output:
  md_document:
    variant: gfm
    preserve_yaml: TRUE
author: "steve"
date: '2025-09-18'
excerpt: "You can do a great deal to learn about quantitative methods through not just replication, but forensics on opaque/unclear data sets you encounter. Sometimes, you'll just have to 'figure it out.'"
layout: post
categories:
  - Teaching
  - R
image: "forensic-files-whos-your-daddy.jpg"
active: blog
---

```{r setup, include=FALSE, cache=F}

rmd_name <- knitr::current_input()
rmd_name <- stringr::str_sub(rmd_name, 12, -1)
rmd_name <- stringr::str_sub(rmd_name, 1, stringr::str_length(rmd_name)-4)


base_dir <- "~/Koofr/svmiller.github.io/"
base_url <- "/"
fig_path <- paste0("images/", rmd_name, "/")

cache_path <- paste0("~/Koofr/svmiller.github.io/cache/", rmd_name, "/")

add_jekyll_image <- function(url, caption, width, align) {
 img <- paste0('{% include image.html url="',url,'" caption="',caption,'" width=',width,' align="',align,'" %}')
 cat(img)
}

add_update <- function(announce, text) {
  
  update <- paste0('{% include updatebox.html announce="',announce,'" text="',text,'" %}')
 cat(update)
  
}

add_announce <- function(announce, text) {
  
  update <- paste0('{% include announcebox.html announce="',announce,'" text="',text,'" %}')
 cat(update)
  
}

knitr::opts_knit$set(base.dir = base_dir, base.url = base_url)
knitr::opts_chunk$set(fig.path = fig_path, dpi= 300,
                      cache.path = cache_path,
                      fig.width = 11,
                      message=FALSE, warning=FALSE,
                      cache = FALSE,
                      collapse = TRUE, comment = "#>") 

# library(tidyverse)     # for most things
# library(stevemisc)     # for graph formatting
# library(kableExtra)    # for tables
# library(stevedata)
# library(modelsummary)
# library(stevethemes)
# library(modelr)
# library(lmtest)
# library(sandwich)
# library(ggdist)
# library(ggrepel)
library(tidyverse)
library(stevedata)
library(stevethemes)
library(modelsummary)
library(kableExtra)
theme_set(theme_steve())

# rawData <- readRDS("~/Dropbox/svmiller.github.io/extdata/world-bank-example-cs.rds")

#library(kableExtra)
# library(modelsummary)
# library(stevethemes)
# library(ggrepel)
# library(modelr)
options(knitr.kable.NA = '')

# theme_set(theme_steve())
```


```{r leadimage, echo=F, eval=T, results="asis", cache=F}
add_jekyll_image('/images/forensic-files-whos-your-daddy.jpg', "Admit it; you heard the theme in your head just looking at this image. Peter Thomas is a ringing voice in my head from grad school.", "350", "right")
```

The impetus for this post is as much a concession of defeat as it is a genuine interest of mine. [Chatbots have seen enough of my material](https://svmiller.com/blog/2025/09/assorted-opinionated-takes-on-chatbot-use-by-students/) that they can effectively do my assignments for apathetic students in both my [upper-division](http://eh6127.svmiller.com/) and [lower-division](https://ir3-2.svmiller.com/) methods courses. I do like the various data sets that I've crammed into [`{stevedata}`](https://svmiller.com/stevedata) and spammed onto CRAN. But, I have to change it up a bit. 

Second, I have a genuine interest in the wild, wild west of what was quantitative political science over 20 years ago. Replication norms when I was starting out were **nowhere** near as rigorous as they are now but computing power became much cheaper and software options became more sophisticated and  user-friendly. It's crazy to look back on the time when Yale hosted the *Journal of Conflict Resolution* and had data repository that has since been lost to history (as far as I'm aware). If you're lucky, you got a replication data set. If you're even luckier, the replication data set almost assuredly posted on a faculty member's website, did not pass away when the university underwent one of many structural changes to its web hosting platforms. That faculty member may have simply moved the files to something more stable or uploaded them to [Dataverse](https://dataverse.harvard.edu/). If you've won the lottery, that replication data set includes a codebook and a script of some description that allows you to reproduce the findings. It's led me to do some sleuthing in the furthest reaches of the web to try to find some of these forgotten materials. I have a [burgeoning Github repository](https://github.com/svmiller/abandoned-datasets) that tries to preserve copies of these data sets.

I also think this is an instructional opportunity for students. [We've known for some time](https://www.cambridge.org/core/journals/ps-political-science-and-politics/article/abs/replication-replication/85C204B396C5060963589BDC1A8E7357) that replication is necessary for (political) science, and the discipline has since caught up for the most part. But what do you do when all you have is a data set? What do you do when the replication script, if you have one, is in a programming language you've never seen before? Well, [figure it out](https://www.youtube.com/watch?v=GfU8CZVNb6o). In the absence of an exact recipe with software you have, you'll have to do what I'll call "replication forensics" to piece together what the author did and how you can translate it to something more current. You have the data. You have the article. [Figure it out](https://www.youtube.com/watch?v=GfU8CZVNb6o).[^noone]

We're going to do that today with one of my favorite articles from graduate school: Kenneth Benoit's (1996) ["Democracies Really Are More Pacific (in General): Reexamining Regime Type and War Involvement"](https://doi.org/10.1177/0022002796040004006). People reading this who are aware of me know that the bulk of my early research was [democratic peace skepticism](https://svmiller.com/blog/2015/04/some-psfrustrations-from-an-ir-perspective). I like this article in particular because it tries to tackle one of the biggest contradictions in the democratic peace corpus: the "monadic" phenomenon that is very much implied but never fully confirmed. Benoit (1996), [like Rousseau et al. (1996)](https://svmiller.com/svm-article-summaries/rousseauetal1996adn/svm-as-rousseauetal1996adn.pdf), gives it an honest effort, but the results aren't terribly convincing the more you look at them. Benoit's (1996) is also very much limited to a particular moment in time for which there isn't much assurance that the findings will generalize.

[^noone]: No one will pay you any serious amount of money to follow a completely prescribed routine. If that were your task, you are immediately replaceable if the next quarterly report looks lukewarm to shareholders.

## Reading Benoit (1996)'s Data 

I found a copy of Benoit's (1996) analyses and [uploaded them](https://github.com/svmiller/abandoned-datasets/tree/main/benoit1996drmp) to one of my Github repositories. Mercifully, you get a README file that will tell you where to look for replicating certain parts of his analysis. You also get various codebooks (as `.cbk` files) to assist you. That's certainly nice, though I will admit I didn't look at them before writing this post and won't look at them now. Seriously. I'm trying to practice what I preach; ["figure it out"](https://www.youtube.com/watch?v=GfU8CZVNb6o).

I want to replicate his Table 2, a screenshot of which follows.

```{r benoittab2, echo=F, eval=T, results="asis", cache=F}
add_jekyll_image('/images/benoit1996-tab2.png', "Table 2 in Benoit (1996)", "596", "center")
```


The README file is pointing me to [the `WEEDE.ASC` file](https://github.com/svmiller/abandoned-datasets/blob/main/benoit1996drmp/WEEDE.ASC) for the data and [the `REG_TAB2.PRG` file](https://github.com/svmiller/abandoned-datasets/blob/main/benoit1996drmp/REG_TAB2.PRG) to replicate this. I'll get to the data shortly, but the reader and I are looking at the contents of these file for the first time. Neither of us, in all likelihood, have used the software that Benoit (1996) used for his analysis: [GAUSS](https://en.wikipedia.org/wiki/GAUSS_(software)). I don't know when exactly GAUSS fell out of favor in my field, but it was certainly before (and likely long before) I joined the field in 2006. Together, we'll [figure it out](https://www.youtube.com/watch?v=GfU8CZVNb6o).

We'll have to load the data before doing anything with them. I can already tell from context clues and, well, opening the `WEEDE.ASC` file in a text editor that there is going to be a small issue. Here are the column names and the first row of the data file.

```
@ ccode	cname	superpwr	butterw	kende	ssm_is	ssm_es	ssis6074	sses6074	ssis7580	sses7580	ssal6080	ssal6074	ssal7580	poldem60	poldem65	civil73	polit73	civil79	polit79	fh73	fh75_80	dembin	area	defexd	defexdpc	encon	enconpc	gnppc	gdppc	impexppc	impexp	ecintdep	tvpc	szmil	szmilpc	popltn	larea	lpopltn	lszmil	lszmilpc	ltvpc	lecintd	limpexpc	limpexp	lencnpc	lgdppc	milwp70	popln70	ecnpc70	trade75	lmilwp70	lpopln70	lecnpc70 @
2	United_States	1	7	14	1	0	1	0	0	0	1	1	0	94.6	92.4	1	1	1	1	14	14	1	3619	76276144	37229	2278900	11127	4953	4501	40192	8234600	0.081	41292	3161	154	204880	3.559	5.311	3.5	2.188	4.616	-1.091	4.604	6.916	4.046	3.653	24.2	204879	11077	13.8	1.3838	5.3115	4.0444
```

That leading `@` is going to be a slight frustration because R will want to read that as a column. There are certainly context clues that come with experience, but even the lay reader can see how this will go awry. My knowledge of the Correlates of War state system tells me that the United States has a state code of 2. It should be the case that `ccode` is the column that has that 2, but R will read a column of `@` as having that 2. I don't want that.

You have one of two options here. The first is to make a copy of the file, erase the `@` and save. That's certainly the easiest way to go about this and it's what I would advise students to do under these circumstances. You could also do something like this.

```{r}
Data <- read_file("~/Koofr/data/benoit1996drmp/WEEDE.ASC") 
# ^ assuming your data are here, which they won't be. Adjust to taste.

substring(Data, 1, 150) # looks gross, but don't worry
Data <- gsub("@", "", Data)
Data <- read_table(Data)

Data # ta-da
```

An approach like this won't be necessary if you're handed a `.sav` file (SPSS format) or a `.dta` file (Stata format), but it's something you'll want to think about if you have a text file offered as a data file. This may just be a GAUSS quirk for all I know, but you should learn to anticipate some of these problems as well.


## Identifying the Variables in Benoit's (1996) Table 2

I've read Benoit's (1996) article to know what he is doing. He's regressing  two different measures of war counts (Butterworth and Small-Singer) on two different measures of democracy ([Bollen's (1980)](https://www.jstor.org/stable/2095172) measure of democracy and a measure of democracy from Freedom House). He will do that for three different estimation techniques: the linear model/OLS, [the Poisson model for counts](https://svmiller.com/blog/2023/12/count-models-poisson-negative-binomial/), and the negative binomial model (used for over-dispersed/under-dispersed counts). 

Again, I can peek at the codebook to figure out what's what, but the goal here is to [figure it out](https://www.youtube.com/watch?v=GfU8CZVNb6o). Let's identify the column names in the data if they'll signal what we want.

```{r}
colnames(Data)
```

Use your eyes, your head, and the context clues from Table 2. Notice Benoit (1996) says that [Butterworth's (1976)](https://www.icpsr.umich.edu/web/ICPSR/studies/7536) conflict data is one of his dependent variables. We can clearly see a column named `butterw`, and the only such column with a name that remotely matches the description we want. That tells us that's our dependent variable. We'll need a bit more sleuthing to discern what could be the Singer-Small data he's using. Three context clues are guiding me here. First, it's usually---not always: usually---the case that the main variables of interest to a researcher are in the first few columns. They're not typically at the end. So, I'm starting to look at the first few columns I see. The second context clue is `ss`, suggesting "`S`inger and `S`mall". I see a few columns that start with that, which all have numbers following them. There's my third context clue: they're signaling the temporal domain of the count of wars. Per Table 2, the temporal domain of these count of wars says they span 1960 to 1980. Putting all those context clues together, I know `ssal6080` is my second dependent variable.

I can do something similar for the two measures of democracy that serve as his independent variables. Benoit (1996) helpfully tells you the political democracy measure benchmarks to 1965. My eyes see two columns as potential candidates for this variable: `poldem60` and `poldem65`. Given the information available, it seems like `poldem65` is the obvious candidate for what he says is "POLDEM 1965" in his analysis. Following this logic, I can again discern what would be the Freedom House measure from 1973. It should be `fh1973`, signaling *F*reedom *H*ouse's measure of democracy in `1973`. Here would be a reduced version of the data.

```{r}
Data %>% 
  select(ccode:cname, butterw, ssal6080, poldem65, fh73)
```

Doing this, though, alerted me to a potential issue I'll want to consider. R read the `poldem65` as a character when I know it should be a numeric variable. We'll have to figure out whath happened.

```{r}
Data %>% distinct(poldem65) %>% pull()
```

It looks like the missing data code for this measure is a `.`. If I knew in advance this was an issue, I could've potentially passed it off as an argument in the `read_table()` function (i.e. `read_table(Data, na = "."`). But, I'm only catching this now. We'll find out what observation this is first before fixing it.

```{r}
Data %>%
  filter(poldem65 == ".") # Burma...

Data %>% mutate(poldem65 = ifelse(poldem65 == ".", NA, poldem65),
                poldem65 = as.numeric(poldem65)) -> Data

Data %>% 
  select(ccode:cname, butterw, ssal6080, poldem65, fh73)
```

Cool, let's proceed.

## Replicating Benoit's (1996) Table 2

There is definitely a convoluted way of making a loop and list of these various models, though it would be beyond the scope of this post to do this and might only serve to overwhelm my students reading this. So, we'll do it the tedious way. Let's do the Butterworth wars first.

```{r}
M1 <- lm(butterw ~ poldem65, Data)
M2 <- lm(butterw ~ fh73, Data)
M3 <- glm(butterw ~ poldem65, Data, family = "poisson")
M4 <- glm(butterw ~ fh73, Data, family = "poisson")
M5 <- MASS::glm.nb(butterw ~ poldem65, Data)
M6 <- MASS::glm.nb(butterw ~ fh73, Data)
```

A regression table, by way of `{modelsummary}`, follows.

<div id ="modelsummary">

```{r, echo=F, eval=T, results='asis'}

modelsummary(list("POLDEM 1965 (OLS)" = M1,
                  "FH 1973 (OLS)" = M2,
                  "POLDEM 1965 (Poisson)" = M3,
                  "FH 1973 (Poisson)" = M4,
                  "POLDEM 1965 (NB)" = M5,
                  "FH 1973 (NB)" = M6),
             stars = TRUE,
             fmt = 4,
             output = 'kableExtra',
             title = "A Replication of Table 2 in Benoit (1996) for Butterworth's Data on Wars",
             coef_map = c("poldem65" = "Democracy",
                          "fh73" = "Democracy",
                          "(Intercept)" = "Intercept"),
             gof_map = c("r.squared", "logLik", "nobs")) %>%
  row_spec(c(1, 2), background = "#e3f4f7", bold=TRUE)

```

</div>

By in large, we've replicated what Benoit (1996) reports in his Table 2 for the analysis of Butterworth's war data. It does come with two caveats that are immediately discernible. The first one is an advanced note in which I have to confess that I have no idea how GAUSS is calculating the log likelihood of the Poisson models. I only know of the one way of doing it (i.e. how R does it: `sum(dpois(M3$y, lambda = fitted(M3), log = TRUE))`). However, that's an advanced note that I cannot earnestly expect students to know (because I wouldn't know it myself). However, the coefficients are identical. The same cannot be said about the negative binomial regression. Here, there is some interesting disagreement. I finally peeked into the information that Benoit (1996) makes available. [The negative binomial regression in the program file](https://github.com/svmiller/abandoned-datasets/blob/main/benoit1996drmp/REG_TAB2.PRG#L128) seems like it was custom written for the task at hand. I can already discern the different parameterizations of dispersion, which are also stated in the footnote of the table. I can already see different starting values for the dispersion parameter, or at least I think I do. I know the `glm.nb()` function in the `{MASS}` package starts with the Poisson and that doesn't seem(?) to be where the negative binomial routine starts in GAUSS. To be clear, the differences are rather slight with all that in mind. But, they can't go unnoticed.

They're also immaterial for my intended audience. I can't expect intro-level students to know those advanced details, but I can expect them to dig into the data to [figure out](https://www.youtube.com/watch?v=GfU8CZVNb6o) the basic information and modeling techniques. Toward that end, we've accomplished the first half of Table 2.

Now, let's round home with a replication of Table 2, but for the Singer and Small wars.


```{r}
M7 <- lm(ssal6080 ~ poldem65, Data)
M8 <- lm(ssal6080 ~ fh73, Data)
M9 <- glm(ssal6080 ~ poldem65, Data, family = "poisson")
M10 <- glm(ssal6080 ~ fh73, Data, family = "poisson")
M11 <- MASS::glm.nb(ssal6080 ~ poldem65, Data)
M12 <- MASS::glm.nb(ssal6080 ~ fh73, Data)
```

Summarize it for us, `{modelsummary}`.

<div id ="modelsummary">

```{r, echo=F, eval=T, results='asis'}

modelsummary(list("POLDEM 1965 (OLS)" = M7,
                  "FH 1973 (OLS)" = M8,
                  "POLDEM 1965 (Poisson)" = M9,
                  "FH 1973 (Poisson)" = M10,
                  "POLDEM 1965 (NB)" = M11,
                  "FH 1973 (NB)" = M12),
             stars = TRUE,
             fmt = 4,
             output = 'kableExtra',
             title = "A Replication of Table 2 in Benoit (1996) for Singer and Small's Data on Wars",
             coef_map = c("poldem65" = "Democracy",
                          "fh73" = "Democracy",
                          "(Intercept)" = "Intercept"),
             gof_map = c("r.squared", "logLik", "nobs")) %>%
  row_spec(c(1, 2), background = "#e3f4f7", bold=TRUE)

```

</div>

The same basic story emerges. We've just about perfectly reproduced the linear model output and the Poisson model output (barring the log-likelihood in the latter). There's also the interesting discrepancy in the negative binomial regression, though we'll have to chalk that up to different optimization and parameterization procedures that I cannot honestly expect students to know at this point in their studies.

## Conclusion

The point of this post isn't to point fingers. I actually rather appreciate that Benoit had these data available *and* actually included a full-fledged codebook, script, and output log to show his work. Speaking from experience, that was rather anomalous for scholarship at this time. Further, the point isn't to further scrutinize democratic peace scholarship anymore than I already have in the bulk of my early published scholarship. This is more of a warning and a sales pitch to my students. You will learn a lot by replication, yes. But, you'll also learn a lot as well by doing some forensic analysis to [figure it out](https://www.youtube.com/watch?v=GfU8CZVNb6o) for yourself how others did in the absence of poorly sourced data. I have an example I'm going to roll out to my Master's students that will be a bit simpler in presentation, but actually won't at all have a codebook or other documentation beyond the published article itself.

You'll just have to [figure it out](https://www.youtube.com/watch?v=GfU8CZVNb6o). You'll learn a lot in the process.